/*-- scss:defaults --*/

// ===========================================
// GPU-Accelerated Mathematical Illustration
// Reveal.js Slide Theme
// ===========================================

// Import fonts (matching website)
@import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400&family=JetBrains+Mono:wght@400;500;600&display=swap');

// Typography
$font-family-sans-serif: "Source Sans 3", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif !default;
$font-family-serif: "Source Serif 4", Georgia, "Times New Roman", serif !default;
$font-family-monospace: "JetBrains Mono", SFMono-Regular, Menlo, Monaco, Consolas, monospace !default;

// Presentation fonts
$presentation-font-size-root: 40px !default;
$presentation-heading-font: $font-family-serif !default;
$presentation-heading-color: #2c3e50 !default;
$presentation-heading-font-weight: 600 !default;

// Heading sizes (relative to root)
$presentation-h1-font-size: 2.0em !default;
$presentation-h2-font-size: 1.5em !default;
$presentation-h3-font-size: 1.2em !default;
$presentation-h4-font-size: 1.0em !default;

// Body text
$body-color: #333 !default;
$body-bg: #fefefe !default;

// Links
$link-color: #347dec !default;
$link-color-hover: lighten($link-color, 10%) !default;

// Code
$code-color: #c7254e !default;
$code-bg: #f8f8f8 !default;
$code-block-bg: #1e1e1e !default;
$code-block-font-size: 0.65em !default;

// Accent colors (matching callouts from website)
$color-note: #347dec !default;
$color-tip: #28a745 !default;
$color-important: #fd7e14 !default;
$color-warning: #ffc107 !default;
$color-caution: #dc3545 !default;


/*-- scss:rules --*/

// ===========================================
// Base Slide Styling
// ===========================================

.reveal {
  font-family: $font-family-sans-serif;

  // Smooth rendering
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

// Headings
.reveal h1, .reveal h2, .reveal h3, .reveal h4 {
  font-family: $presentation-heading-font;
  font-weight: $presentation-heading-font-weight;
  letter-spacing: -0.02em;
  line-height: 1.2;
  margin-bottom: 0.5em;
}

.reveal h1 {
  border-bottom: 3px solid $link-color;
  padding-bottom: 0.3em;
  display: inline-block;
}

.reveal h2 {
  color: $presentation-heading-color;
}

// Section title slides
.reveal .slide.section h1,
.reveal .slide.section h2 {
  border: none;
  text-align: center;
}

// ===========================================
// Code Blocks - Large, readable, light on dark
// ===========================================

// All code containers
.reveal pre,
.reveal div.sourceCode,
.reveal pre.sourceCode {
  width: 100%;
  margin: 0.5em 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  border-radius: 8px;
  background: #1e1e1e !important;
}

// All code text - FORCE large white text
.reveal pre,
.reveal pre code,
.reveal pre.sourceCode,
.reveal pre.sourceCode code,
.reveal div.sourceCode pre,
.reveal div.sourceCode pre code,
.reveal code.sourceCode,
.reveal pre code span,
.reveal div.sourceCode pre code span {
  font-family: $font-family-monospace !important;
  font-size: 26px !important;
  line-height: 1.5 !important;
  color: #e0e0e0 !important;
  background: #1e1e1e !important;
}

.reveal pre code,
.reveal div.sourceCode pre code {
  display: block;
  padding: 1em 1.2em !important;
  max-height: 600px;
  border-radius: 8px;
  overflow: auto;
}

// Pandoc syntax highlighting classes
.reveal pre code span.kw,
.reveal .sourceCode span.kw { color: #569cd6 !important; } // keyword
.reveal pre code span.dt,
.reveal .sourceCode span.dt { color: #4ec9b0 !important; } // data type
.reveal pre code span.dv,
.reveal .sourceCode span.dv { color: #b5cea8 !important; } // decimal value
.reveal pre code span.bn,
.reveal .sourceCode span.bn { color: #b5cea8 !important; } // base n
.reveal pre code span.fl,
.reveal .sourceCode span.fl { color: #b5cea8 !important; } // float
.reveal pre code span.ch,
.reveal .sourceCode span.ch { color: #ce9178 !important; } // char
.reveal pre code span.st,
.reveal .sourceCode span.st { color: #ce9178 !important; } // string
.reveal pre code span.co,
.reveal .sourceCode span.co { color: #6a9955 !important; } // comment
.reveal pre code span.ot,
.reveal .sourceCode span.ot { color: #9cdcfe !important; } // other
.reveal pre code span.fu,
.reveal .sourceCode span.fu { color: #dcdcaa !important; } // function
.reveal pre code span.cf,
.reveal .sourceCode span.cf { color: #c586c0 !important; } // control flow
.reveal pre code span.op,
.reveal .sourceCode span.op { color: #d4d4d4 !important; } // operator
.reveal pre code span.pp,
.reveal .sourceCode span.pp { color: #c586c0 !important; } // preprocessor
.reveal pre code span.at,
.reveal .sourceCode span.at { color: #9cdcfe !important; } // attribute
.reveal pre code span.va,
.reveal .sourceCode span.va { color: #9cdcfe !important; } // variable
.reveal pre code span.bu,
.reveal .sourceCode span.bu { color: #4ec9b0 !important; } // built-in
.reveal pre code span.cn,
.reveal .sourceCode span.cn { color: #569cd6 !important; } // constant
.reveal pre code span.sc,
.reveal .sourceCode span.sc { color: #d7ba7d !important; } // special char

// Inline code (in paragraphs and lists, NOT in pre blocks)
.reveal p > code,
.reveal li > code,
.reveal td > code {
  font-family: $font-family-monospace !important;
  font-size: 0.9em !important;
  background: rgba(0, 0, 0, 0.08) !important;
  color: #c7254e !important;
  padding: 0.15em 0.4em;
  border-radius: 4px;
}

// ===========================================
// Shader Slides - TRULY FULLSCREEN (shader-slide shortcode)
// ===========================================

// Target the container div from shader-slide shortcode
.reveal section [id^="slide-"] {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 1 !important;
}

// Force ALL descendants to fill - whatever embed.js creates
.reveal section [id^="slide-"] * {
  max-width: 100% !important;
  max-height: 100% !important;
}

// Target canvas specifically - most WebGL embeds use canvas
.reveal section [id^="slide-"] canvas {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  object-fit: contain !important;
}

// Target common embed.js wrapper patterns
.reveal section [id^="slide-"] > div,
.reveal section [id^="slide-"] > div > div,
.reveal section [id^="slide-"] > div > div > div {
  width: 100% !important;
  height: 100% !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
}

// Hide any UI controls embed.js might add
.reveal section [id^="slide-"] button,
.reveal section [id^="slide-"] .controls,
.reveal section [id^="slide-"] .ui {
  display: none !important;
}

// ===========================================
// Shader Demos - Regular size (shader-demo shortcode)
// ===========================================

// The figure wrapper from shader-demo extension
.reveal figure.shader-demo {
  width: 100% !important;
  height: 75vh !important;
  min-height: 550px !important;
  margin: 0.2em 0 !important;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

// The inner div (has inline style we must override)
.reveal figure.shader-demo > div {
  width: 100% !important;
  height: 100% !important;
  min-height: 550px !important;
}

// Canvas inside the demo
.reveal figure.shader-demo canvas {
  width: 100% !important;
  height: 100% !important;
}

// Captions below demos
.reveal figure.shader-demo figcaption {
  font-size: 0.55em;
  color: #666;
  margin-top: 0.2em;
  font-style: italic;
  text-align: center;
}

// Generic figures
.reveal figure {
  margin: 0.3em 0;
  width: 100%;
}

.reveal iframe {
  border: none;
  border-radius: 8px;
}

// ===========================================
// Lists
// ===========================================

.reveal ul, .reveal ol {
  margin-left: 0;
  text-align: left;
}

.reveal li {
  margin-bottom: 0.4em;
  line-height: 1.4;
}

// Incremental reveal styling
.reveal .fragment {
  transition: opacity 0.3s ease;
}

// Nested lists
.reveal ul ul, .reveal ol ol {
  font-size: 0.9em;
  margin-top: 0.3em;
  color: #555;
}

// ===========================================
// Math
// ===========================================

.reveal .math {
  font-size: 0.95em;
}

// Display math: give it room
.reveal .math.display {
  margin: 0.8em 0;
}

// ===========================================
// Columns Layout
// ===========================================

.reveal .columns {
  display: flex;
  gap: 2em;
  align-items: flex-start;
}

.reveal .column {
  flex: 1;
}

// Common pattern: code on left, demo on right
.reveal .columns.code-demo {
  .column:first-child {
    flex: 1.2;
  }
  .column:last-child {
    flex: 0.8;
  }
}

// ===========================================
// Callouts (matching website style)
// ===========================================

.reveal .callout {
  border-radius: 6px;
  border: none;
  border-left: 5px solid;
  background-color: #f7f7f7;
  padding: 0.6em 1em;
  margin: 0.8em 0;
  text-align: left;
  font-size: 0.85em;
}

.reveal .callout-title {
  font-weight: 600;
  margin-bottom: 0.3em;
}

.reveal .callout-note { border-left-color: $color-note; }
.reveal .callout-tip { border-left-color: $color-tip; }
.reveal .callout-important { border-left-color: $color-important; }
.reveal .callout-warning { border-left-color: $color-warning; }
.reveal .callout-caution { border-left-color: $color-caution; }

// Hide callout icons in slides (cleaner look)
.reveal .callout-icon-container {
  display: none;
}

// ===========================================
// Special Slide Classes
// ===========================================

// Title slide
.reveal .title-slide {
  h1 {
    font-size: 2.2em;
    margin-bottom: 0.2em;
  }

  .subtitle {
    font-size: 1.1em;
    color: #666;
    font-style: italic;
  }

  .author, .date {
    font-size: 0.9em;
    color: #888;
  }
}

// Centered content
.reveal .slide.center {
  text-align: center;

  h2 {
    margin-bottom: 0.8em;
  }
}

// Smaller text for dense slides
.reveal .slide.smaller {
  font-size: 0.85em;

  pre code {
    font-size: 0.6em;
  }
}

// Full-bleed demo slides (use {.demo-slide} on slide)
.reveal section.demo-slide {
  padding: 0.2em;

  h2 {
    font-size: 1.1em;
    margin-bottom: 0.2em;
  }

  figure.shader-demo {
    height: 82vh !important;
    min-height: 650px !important;
  }

  figure.shader-demo > div,
  figure.shader-demo canvas {
    height: 100% !important;
  }
}

// ===========================================
// Progress & Controls
// ===========================================

.reveal .progress {
  height: 4px;
  color: $link-color;
}

.reveal .controls {
  color: $link-color;
}

// Slide numbers
.reveal .slide-number {
  font-family: $font-family-sans-serif;
  font-size: 14px;
  color: #999;
  background: transparent;
}

// ===========================================
// Print / PDF Export
// ===========================================

@media print {
  .reveal pre code {
    max-height: none;
  }

  .reveal .slide {
    page-break-inside: avoid;
  }
}

// ===========================================
// Dark Mode (future consideration)
// ===========================================

// If you want dark slides, uncomment and modify:
// .reveal {
//   background: #1a1a2e;
//   color: #eee;
//
//   h1, h2, h3, h4 {
//     color: #fff;
//   }
//
//   .callout {
//     background: #2a2a3a;
//   }
// }
